#!/usr/bin/env bash
#PBS -l walltime=16:50:05
#PBS -l mem=15gb
#PBS -N exp2NN
#PBS -m n
echo "Hello ${1}"
# 21Go takes into account for 2 coloc with the same sar measurement
# parallelisation a 60 sur datarmor avec 1 compte 19Go RAM et 06h par sub job de 18 tiff (6h ca fait bcp)
# parallelisation a 54 sur datarmor avec 1 compte 21Go RAM et 06h20 par sub job de 18 tiff
#version pour exploit airflow PRUN daily computation with user satwave
myvariable=$(whoami)

#if [[ "${myvariable}" == "agrouaze" ]]; then
#echo 'je suis agrouaze'

pybin=/home/datawork-cersat-public/project/mpc-sentinel1/workspace/conda/envs/xsar_pr46/bin/python #changed in may 2022
pyexe=/home1/datahome/agrouaze/git/sar_hs_nn/sarhspredictor/bin/rebuild_training_dataset_exp2.py
export PYTHONPATH=/home1/datahome/agrouaze/git/calval_cfo_scat/cfoscatcalval
export PYTHONPATH=/home1/datahome/agrouaze/git/calval_cfo_scat/:$PYTHONPATH
#export PYTHONPATH=/home1/datahome/agrouaze/git/xsarseafork/src/xsarsea:$PYTHONPATH
#export PYTHONPATH=/home1/datahome/agrouaze/git/xsarseafork/src/:$PYTHONPATH
export PYTHONPATH=/home1/datahome/agrouaze/git/sar_hs_nn:$PYTHONPATH
export PYTHONPATH=/home1/datahome/agrouaze/git/sar_hs_nn/sarhspredictor/lib:$PYTHONPATH
export PYTHONPATH=/home1/datahome/agrouaze/git/mpc/data_collect/:$PYTHONPATH
#else
#  pybin=/home1/datawork/agrouaze/conda_envs2/envs/xsarQuach2020/bin/python
#  export PYTHONPATH=/home1/datahome/satwave/sources_en_exploitation2/calval_cfo_scat/cfoscatcalval
#  export PYTHONPATH=/home1/datahome/satwave/sources_en_exploitation2/calval_cfo_scat/:$PYTHONPATH
#  pyexe=/home1/datahome/satwave/sources_en_exploitation2/calval_cfo_scat/cfoscatcalval/src/MLE_aggregation_per_day_L2B.py
#fi
#outdd=/home/datawork-cersat-public/project/mpc-sentinel1/analysis/s1_data_analysis/hs_nn/exp2D4/v1/
$pybin $pyexe --redo --date ${1} --sar-unit ${2} --alti ${3} --outputdir ${4}
echo end of python script exe
exit 0
